<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.17.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="_static/stylesheets/application.css"/> <link rel=stylesheet  href="_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XX133829453-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-XX133829453-1'); </script> <title>Broadcasting &#8212; Practical Data Science</title> <link rel=stylesheet  type="text/css" href="_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="_static/material.css" /> <script data-url_root="./" id=documentation_options  src="_static/documentation_options.js"></script> <script src="_static/jquery.js"></script> <script src="_static/underscore.js"></script> <script src="_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="_static/mids_logo.svg"/> <link rel=index  title=Index  href=genindex.html  /> <link rel=search  title=Search  href=search.html  /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#41_broadcasting" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href=index.html  title="Practical Data Science" class="md-header-nav__button md-logo"> <img src="_static/mids_logo.svg" height=26  alt="Practical Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Practical Data Science</span> <span class=md-header-nav__topic > Broadcasting </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action=search.html  method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="_static/javascripts/version_dropdown.js"></script> <script> var json_loc = ""versions.json"", target_loc = "../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=index.html  class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href=class_schedule.html  class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href=topic_list.html  class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href=index.html  title="Practical Data Science" class="md-nav__button md-logo"> <img src="_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href=index.html  title="Practical Data Science">Practical Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href=class_schedule.html  class=md-nav__link >Class Schedule</a> <li class=md-nav__item > <a href=autograder_guidelines.html  class=md-nav__link >Autograder Guidelines</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Environment Setup</span></span> <li class=md-nav__item > <a href=setup_python.html  class=md-nav__link >Setup Python and miniconda</a> <li class=md-nav__item > <a href=setup_vscode.html  class=md-nav__link >Setup VS Code</a> <li class=md-nav__item > <a href=setup_augmented_commandline.html  class=md-nav__link >Setup Command Line</a> <li class=md-nav__item > <a href=jupyter.html  class=md-nav__link >Setup Jupyter</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Basic Tools</span></span> <li class=md-nav__item > <a href=command_line_part1.html  class=md-nav__link >Command Line, Basics</a> <li class=md-nav__item > <a href=command_line_part2.html  class=md-nav__link >Command Line, Advanced</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Python &amp; Pandas</span></span> <li class=md-nav__item > <a href=python_v_r.html  class=md-nav__link >Python / R Differences</a> <li class=md-nav__item > <a href=vars_v_objects.html  class=md-nav__link >Python: Vars v Objects</a> <li class=md-nav__item > <a href=ints_and_floats.html  class=md-nav__link >Numbers in Computers</a> <li class=md-nav__item > <a href=pandas_series.html  class=md-nav__link >Pandas 1: Series</a> <li class=md-nav__item > <a href=plotting_altair_part1.html  class=md-nav__link >Plotting, Basics</a> <li class=md-nav__item > <a href=plotting_altair_part2.html  class=md-nav__link >Plotting, Advanced</a> <li class=md-nav__item > <a href=views_and_copies_in_pandas.html  class=md-nav__link >Pandas 3: Views</a> <li class=md-nav__item > <a href=parquet.html  class=md-nav__link >Parquet Format</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >DS Concepts</span></span> <li class=md-nav__item > <a href=defensive_programming.html  class=md-nav__link >Defensive Programming</a> <li class=md-nav__item > <a href=workflow.html  class=md-nav__link >Workflow Management</a> <li class=md-nav__item > <a href=backwards_design.html  class=md-nav__link >Backwards Design</a> <li class=md-nav__item > <a href=getting_help.html  class=md-nav__link >Getting Help Online</a> <li class=md-nav__item > <a href=what_is_big_data.html  class=md-nav__link >What is Big Data?</a> <li class=md-nav__item > <a href=big_data_strategies.html  class=md-nav__link >Working with Big Data</a> <li class=md-nav__item > <a href=performance_understanding.html  class=md-nav__link >Understanding Performance</a> <li class=md-nav__item > <a href=performance_solutions.html  class=md-nav__link >Solving Performance Probs</a> <li class=md-nav__item > <a href=parallelism.html  class=md-nav__link >Parallel Computing</a> <li class=md-nav__item > <a href=distributed_computing.html  class=md-nav__link >Distributed Computing</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Git and Github</span></span> <li class=md-nav__item > <a href=git_and_github.html  class=md-nav__link >Git and Github</a> <li class=md-nav__item > <a href=pr_review.html  class=md-nav__link >Reviewing Code on Github</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >GIS</span></span> <li class=md-nav__item > <a href=gis_what_is_gis.html  class=md-nav__link >What is GIS?</a> <li class=md-nav__item > <a href=gis_setup_geopandas.html  class=md-nav__link >Installing Geopandas</a> <li class=md-nav__item > <a href=gis_geopandas.html  class=md-nav__link >Geopandas</a> <li class=md-nav__item > <a href=gis_spatial_joins.html  class=md-nav__link >Merging Spatial Data</a> <li class=md-nav__item > <a href=gis_data.html  class=md-nav__link >Spatial Data Formats</a> <li class=md-nav__item > <a href=gis_projections.html  class=md-nav__link >Spatial Projections</a> <li class=md-nav__item > <a href=gis_crs_geopandas.html  class=md-nav__link >Managing Projections in Geopandas</a> <li class=md-nav__item > <a href=gis_mapping.html  class=md-nav__link >Mapping with Geopandas</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Other</span></span> <li class=md-nav__item > <a href=buying_datascience_computer.html  class=md-nav__link >Buying a Data Science Computer</a> <li class=md-nav__item > <a href=not_a_mids_student.html  class=md-nav__link >Not a MIDS Student?</a> <li class=md-nav__item > <a href=cheatsheets.html  class=md-nav__link >Cheat Sheets</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#41-broadcasting--page-root" class=md-nav__link >Broadcasting</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Broadcasting-Rules" class=md-nav__link >Broadcasting Rules</a> <li class=md-nav__item ><a href="#A-Common-Gotcha:-Narrow-Matrices-v.-1-Dimensional-Vectors" class=md-nav__link >A Common Gotcha: Narrow Matrices v. 1-Dimensional Vectors</a> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt .copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ .jp-RenderedHTMLCommon table, div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } .jp-RenderedHTMLCommon thead, div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } .jp-RenderedHTMLCommon tr, .jp-RenderedHTMLCommon th, .jp-RenderedHTMLCommon td, div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } .jp-RenderedHTMLCommon th, div.rendered_html th { font-weight: bold; } .jp-RenderedHTMLCommon tbody tr:nth-child(odd), div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .jp-RenderedHTMLCommon tbody tr:hover, div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <section id=Broadcasting > <h1 id=41-broadcasting--page-root >Broadcasting<a class=headerlink  href="#41-broadcasting--page-root" title="Permalink to this headline">¶</a></h1> <p>The fact that vectors and matrices are just special cases of arrays, and that arrays can have any number of dimensions and any shape, raises an obvious question: how do arrays of different shapes and numbers of dimensions interact?</p> <p>The answer is that in situations where there is a principled way for arrays of different shapes to interact with one another, numpy will allow operations like adding or multiplying the arrays via a process called <strong>broadcasting.</strong></p> <p>Broadcasting is actually something that you’ve already been exposed to implicitly. When working with vectors, for example, we talked about how, if we try to do math with two vectors of the same length, numpy will apply our mathematical operation element wise, matching the first entry in the first vector to the first entry in the second vector, the second entry in the first vector to the second entry in the second vector, etc:</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=n >v1</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >])</span>
<span class=n >v2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >4</span><span class=p >,</span> <span class=mi >5</span><span class=p >,</span> <span class=mi >6</span><span class=p >])</span>
<span class=n >v1</span> <span class=o >+</span> <span class=n >v2</span>
</pre></div> </div> </div> <img alt=Broadcasting  src="_images/2.3.41-broadcasting_0.png"/> <p>Or, if one of the two vectors is of length one (or we are working with a regular scaler number that isn’t a vector), numpy will <em>broadcast</em> the operation by applying the operation between the single number and each entry and the longer vector:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >v1</span> <span class=o >+</span> <span class=mi >1</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([2, 3, 4])
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >v1</span> <span class=o >+</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >1</span><span class=p >])</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([2, 3, 4])
</pre></div></div> </div> <img alt=Broadcasting  src="_images/2.3.41-broadcasting_1.png"/> <p>And if we try to do math with two vectors when the lengths aren’t the same and one of the vectors is not of length one the case, we get a <code class="docutils literal notranslate"><span class=pre >ValueError:</span> <span class=pre >operand</span> <span class=pre >could</span> <span class=pre >not</span> <span class=pre >be</span> <span class=pre >broadcast</span> <span class=pre >together</span></code> error. For example, numpy could not do <code class="docutils literal notranslate"><span class=pre >np.array([1,</span> <span class=pre >2,</span> <span class=pre >3])</span> <span class=pre >+</span> <span class=pre >np.array([1,</span> <span class=pre >2])</span></code>.</p> <p>And indeed, this is basically the first rule of broadcasting: it only works when the length of the arrays along the dimension over which you are broadcasting have the same length, or where one is of length 1.</p> <section id=Broadcasting-Rules > <h2 id=Broadcasting-Rules >Broadcasting Rules<a class=headerlink  href="#Broadcasting-Rules" title="Permalink to this headline">¶</a></h2> <p>So what happens if we’re dealing with arrays with more than one dimension? And what do we do if our arrays have different numbers of dimensions – e.g. can I make a vector interact with a matrix, or a matrix interact with a three-dimensional array?</p> <p>The answer is that numpy addresses these situations by looking at the shapes of the two arrays (e.g. <code class="docutils literal notranslate"><span class=pre >my_array.shape</span></code>) – starting with the rightmost dimension – to see if matched the dimensions have compatible lengths (e.g. are the same or one is length 1). If so, broadcasting will occur accordingly, and if not you’ll get a <code class="docutils literal notranslate"><span class=pre >ValueError:</span> <span class=pre >operands</span> <span class=pre >could</span> <span class=pre >not</span> <span class=pre >be</span> <span class=pre >broadcast</span> <span class=pre >together</span></code> error.</p> <p>OK, that was a lot of terms, so let’s be concrete: suppose have a vector of length 3 and a matrix that is 2 x 3:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >my_vector</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >])</span>
<span class=n >my_matrix</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >],</span> <span class=p >[</span><span class=mi >4</span><span class=p >,</span> <span class=mi >5</span><span class=p >,</span> <span class=mi >6</span><span class=p >]])</span>
<span class=n >my_matrix</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[1, 2, 3],
       [4, 5, 6]])
</pre></div></div> </div> <p>Now suppose we wanted to add these together. Could we do that? To answer that question, numpy would start by comparing the shapes of the two arrays: <code class="docutils literal notranslate"><span class=pre >(3,)</span></code> and <code class="docutils literal notranslate"><span class=pre >(2,</span> <span class=pre >3)</span></code>. Starting at the rightmost entry, it would then try and match these up, so it would match <code class="docutils literal notranslate"><span class=pre >3</span></code> to <code class="docutils literal notranslate"><span class=pre >3</span></code>. Then it would ask: are these the same, or is one equal to 1? Here the answer is yes, so numpy would <em>broadcast</em> the operation by applying it repeatedly along each row (the extra dimension in the matrix):</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >my_vector</span> <span class=o >+</span> <span class=n >my_matrix</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[2, 4, 6],
       [5, 7, 9]])
</pre></div></div> </div> <img alt=Broadcasting  src="_images/2.3.41-broadcasting_2.png"/> <p>But what if my matrix had been 3x2 instead of 2x3? Well, then numpy would have matched <code class="docutils literal notranslate"><span class=pre >3</span></code> (the vector length) to the right most entry in <code class="docutils literal notranslate"><span class=pre >my_matrix2.shape</span></code> (<code class="docutils literal notranslate"><span class=pre >2</span></code>), found they were different and that neither was 1, so it would just raise an error:</p> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=n >my_matrix2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >],</span> <span class=p >[</span><span class=mi >3</span><span class=p >,</span> <span class=mi >4</span><span class=p >],</span> <span class=p >[</span><span class=mi >5</span><span class=p >,</span> <span class=mi >6</span><span class=p >]])</span>
<span class=n >my_vector</span> <span class=o >+</span> <span class=n >my_matrix2</span>

<span class=o >---------------------------------------------------------------------------</span>
<span class=ne >ValueError</span>                                <span class=n >Traceback</span> <span class=p >(</span><span class=n >most</span> <span class=n >recent</span> <span class=n >call</span> <span class=n >last</span><span class=p >)</span>
<span class=o >/</span><span class=n >var</span><span class=o >/</span><span class=n >folders</span><span class=o >/</span><span class=n >tj</span><span class=o >/</span><span class=n >s8f2_ks15h315z5thvtnhz8r0000gp</span><span class=o >/</span><span class=n >T</span><span class=o >/</span><span class=n >ipykernel_16753</span><span class=o >/</span><span class=mf >2980522362.</span><span class=n >py</span> <span class=ow >in</span> <span class=o >&lt;</span><span class=n >module</span><span class=o >&gt;</span>
      <span class=mi >1</span> <span class=n >my_matrix2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >],[</span> <span class=mi >3</span><span class=p >,</span> <span class=mi >4</span><span class=p >],</span> <span class=p >[</span><span class=mi >5</span><span class=p >,</span> <span class=mi >6</span><span class=p >]])</span>
<span class=o >----&gt;</span> <span class=mi >2</span> <span class=n >my_vector</span> <span class=o >+</span> <span class=n >my_matrix2</span>

<span class=ne >ValueError</span><span class=p >:</span> <span class=n >operands</span> <span class=n >could</span> <span class=ow >not</span> <span class=n >be</span> <span class=n >broadcast</span> <span class=n >together</span> <span class=k >with</span> <span class=n >shapes</span> <span class=p >(</span><span class=mi >3</span><span class=p >,)</span> <span class=p >(</span><span class=mi >3</span><span class=p >,</span><span class=mi >2</span><span class=p >)</span>
</pre></div> </div> </section> <section id="A-Common-Gotcha:-Narrow-Matrices-v.-1-Dimensional-Vectors"> <h2 id="A-Common-Gotcha:-Narrow-Matrices-v.-1-Dimensional-Vectors">A Common Gotcha: Narrow Matrices v. 1-Dimensional Vectors<a class=headerlink  href="#A-Common-Gotcha:-Narrow-Matrices-v.-1-Dimensional-Vectors" title="Permalink to this headline">¶</a></h2> <p>And now a common issue people run into related to broadcasting: in numpy, there is a distinction between a 1-dimensional vector (the data structure we used throughout Week 2), and a 2-dimensional matrix with only 1 row or 1 column.</p> <p>To illustrate, let’s start by creating a simple vector and getting its <code class="docutils literal notranslate"><span class=pre >.shape</span></code>:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >my_vector</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >])</span>
<span class=n >my_vector</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([1, 2, 3])
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >my_vector</span><span class=o >.</span><span class=n >shape</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(3,)
</pre></div></div> </div> <p>As we can see, numpy only reports the size of our vector in one dimension (the trailing comma is included so you know that it’s a list with one entry, not a weirdly formatted 3). One value is given because our data is one-dimensional.</p> <p>But if we create a matrix with one row and three columns (note I’m passing a list within a list to <code class="docutils literal notranslate"><span class=pre >np.array</span></code>), we get a data structure that <em>looks</em> similar, but is actually different in an important way, as evident from the output of <code class="docutils literal notranslate"><span class=pre >.shape</span></code>:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >skinny_matrix</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([[</span><span class=mi >1</span><span class=p >],</span> <span class=p >[</span><span class=mi >2</span><span class=p >],</span> <span class=p >[</span><span class=mi >3</span><span class=p >]])</span>
<span class=n >skinny_matrix</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[1],
       [2],
       [3]])
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >skinny_matrix</span><span class=o >.</span><span class=n >shape</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(3, 1)
</pre></div></div> </div> <p>As we can see, this matrix is two-dimensional, as evidenced by the fact the <code class="docutils literal notranslate"><span class=pre >.shape</span></code> is reporting two numbers.</p> <p>This distinction is important because these differences in the shape of our arrays impact how numpy broadcasts operations. For example, let’s suppose that we wanted to add the contents of <code class="docutils literal notranslate"><span class=pre >skinny_matrix</span></code> to the contents of <code class="docutils literal notranslate"><span class=pre >my_vector</span></code>. Intuitively, these both have three entries, so we would think that they would add up element-wise, just the same way they would if we added up <code class="docutils literal notranslate"><span class=pre >my_vector</span></code> with itself:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >my_vector</span> <span class=o >+</span> <span class=n >my_vector</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([2, 4, 6])
</pre></div></div> </div> <p>But that’s not what happens:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >skinny_matrix</span> <span class=o >+</span> <span class=n >my_vector</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[2, 3, 4],
       [3, 4, 5],
       [4, 5, 6]])
</pre></div></div> </div> <p>Why? Because the shape of <code class="docutils literal notranslate"><span class=pre >skinny_matrix</span></code> is <code class="docutils literal notranslate"><span class=pre >(3,</span> <span class=pre >1)</span></code>, when numpy looks at the length of the rightmost dimension, it finds the value <code class="docutils literal notranslate"><span class=pre >1</span></code>, so instead of matching up the elements one to one, it applies the addition operation between <code class="docutils literal notranslate"><span class=pre >my_vector</span></code> and each row, generating a three by three matrix.</p> <img alt=Broadcasting  src="_images/2.3.41-broadcasting_3.png"/> <p>To avoid this type of behavior, we just need to reshape <code class="docutils literal notranslate"><span class=pre >skinny_matrix</span></code> said that it is actually one-dimensional:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >now_a_vector</span> <span class=o >=</span> <span class=n >skinny_matrix</span><span class=o >.</span><span class=n >reshape</span><span class=p >(</span><span class=mi >3</span><span class=p >)</span>
<span class=n >now_a_vector</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([1, 2, 3])
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >now_a_vector</span><span class=o >.</span><span class=n >shape</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(3,)
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >now_a_vector</span> <span class=o >+</span> <span class=n >my_vector</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([2, 4, 6])
</pre></div></div> </div> <p>Or we could use <code class="docutils literal notranslate"><span class=pre >.reshape</span></code> to make our original one dimensional vector a matrix with the same shape is our <code class="docutils literal notranslate"><span class=pre >skinny_matrix</span></code>:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >now_a_matrix</span> <span class=o >=</span> <span class=n >my_vector</span><span class=o >.</span><span class=n >reshape</span><span class=p >((</span><span class=mi >3</span><span class=p >,</span> <span class=mi >1</span><span class=p >))</span>
<span class=n >now_a_matrix</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[1],
       [2],
       [3]])
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >now_a_matrix</span><span class=o >.</span><span class=n >shape</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(3, 1)
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >skinny_matrix</span> <span class=o >+</span> <span class=n >now_a_matrix</span>
<br/></pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[2],
       [4],
       [6]])
</pre></div></div> </div> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>